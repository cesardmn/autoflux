import{r as ut,a as st,g as lt}from"./@xmldom-BSdgGZWi.js";import{r as Z}from"./underscore-D8pyYJcL.js";import{r as ot}from"./bluebird-5d01fNRq.js";import{r as ct}from"./base64-js-DRz5BQNA.js";import{r as ft}from"./jszip-Crv52XZ3.js";import{r as mt}from"./xmlbuilder-m9dXxFQd.js";import{r as dt}from"./dingbat-to-unicode-CMGDyNm5.js";import{r as Jr}from"./lop-Cdh-pw7Y.js";var ee={},_e={},re={},cr;function fe(){if(cr)return re;cr=1;var f=Z,e=ot()();re.defer=a,re.when=e.resolve,re.resolve=e.resolve,re.all=e.all,re.props=e.props,re.reject=e.reject,re.promisify=e.promisify,re.mapSeries=e.mapSeries,re.attempt=e.attempt,re.nfcall=function(o){var c=Array.prototype.slice.call(arguments,1),s=e.promisify(o);return s.apply(null,c)},e.prototype.fail=e.prototype.caught,e.prototype.also=function(o){return this.then(function(c){var s=f.extend({},c,o(c));return e.props(s)})};function a(){var o,c,s=new e.Promise(function(r,t){o=r,c=t});return{resolve:o,reject:c,promise:s}}return re}var D={},fr;function ye(){if(fr)return D;fr=1;var f=Z,e=D.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function a(v,R){return R=R||{},{type:e.document,children:v,notes:R.notes||new p({}),comments:R.comments||[]}}function o(v,R){R=R||{};var S=R.indent||{};return{type:e.paragraph,children:v,styleId:R.styleId||null,styleName:R.styleName||null,numbering:R.numbering||null,alignment:R.alignment||null,indent:{start:S.start||null,end:S.end||null,firstLine:S.firstLine||null,hanging:S.hanging||null}}}function c(v,R){return R=R||{},{type:e.run,children:v,styleId:R.styleId||null,styleName:R.styleName||null,isBold:!!R.isBold,isUnderline:!!R.isUnderline,isItalic:!!R.isItalic,isStrikethrough:!!R.isStrikethrough,isAllCaps:!!R.isAllCaps,isSmallCaps:!!R.isSmallCaps,verticalAlignment:R.verticalAlignment||s.baseline,font:R.font||null,fontSize:R.fontSize||null,highlight:R.highlight||null}}var s={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function r(v){return{type:e.text,value:v}}function t(){return{type:e.tab}}function n(v){return{type:e.checkbox,checked:v.checked}}function l(v,R){return{type:e.hyperlink,children:v,href:R.href,anchor:R.anchor,targetFrame:R.targetFrame}}function w(v){return{type:e.noteReference,noteType:v.noteType,noteId:v.noteId}}function p(v){this._notes=f.indexBy(v,function(R){return y(R.noteType,R.noteId)})}p.prototype.resolve=function(v){return this.findNoteByKey(y(v.noteType,v.noteId))},p.prototype.findNoteByKey=function(v){return this._notes[v]||null};function u(v){return{type:e.note,noteType:v.noteType,noteId:v.noteId,body:v.body}}function m(v){return{type:e.commentReference,commentId:v.commentId}}function k(v){return{type:e.comment,commentId:v.commentId,body:v.body,authorName:v.authorName,authorInitials:v.authorInitials}}function y(v,R){return v+"-"+R}function h(v){return{type:e.image,read:function(R){return R?v.readImage(R):v.readImage().then(function(S){return Buffer.from(S)})},readAsArrayBuffer:function(){return v.readImage()},readAsBase64String:function(){return v.readImage("base64")},readAsBuffer:function(){return v.readImage().then(function(R){return Buffer.from(R)})},altText:v.altText,contentType:v.contentType}}function T(v,R){return R=R||{},{type:e.table,children:v,styleId:R.styleId||null,styleName:R.styleName||null}}function P(v,R){return R=R||{},{type:e.tableRow,children:v,isHeader:R.isHeader||!1}}function B(v,R){return R=R||{},{type:e.tableCell,children:v,colSpan:R.colSpan==null?1:R.colSpan,rowSpan:R.rowSpan==null?1:R.rowSpan}}function I(v){return{type:e.break,breakType:v}}function E(v){return{type:e.bookmarkStart,name:v.name}}return D.document=D.Document=a,D.paragraph=D.Paragraph=o,D.run=D.Run=c,D.text=D.Text=r,D.tab=D.Tab=t,D.checkbox=D.Checkbox=n,D.Hyperlink=l,D.noteReference=D.NoteReference=w,D.Notes=p,D.Note=u,D.commentReference=m,D.comment=k,D.Image=h,D.Table=T,D.TableRow=P,D.TableCell=B,D.lineBreak=I("line"),D.pageBreak=I("page"),D.columnBreak=I("column"),D.BookmarkStart=E,D.verticalAlignment=s,D}var Re={},mr;function se(){if(mr)return Re;mr=1;var f=Z;Re.Result=e,Re.success=a,Re.warning=o,Re.error=c;function e(n,l){this.value=n,this.messages=l||[]}e.prototype.map=function(n){return new e(n(this.value),this.messages)},e.prototype.flatMap=function(n){var l=n(this.value);return new e(l.value,s([this,l]))},e.prototype.flatMapThen=function(n){var l=this;return n(this.value).then(function(w){return new e(w.value,s([l,w]))})},e.combine=function(n){var l=f.flatten(f.pluck(n,"value")),w=s(n);return new e(l,w)};function a(n){return new e(n,[])}function o(n){return{type:"warning",message:n}}function c(n){return{type:"error",message:n.message,error:n}}function s(n){var l=[];return f.flatten(f.pluck(n,"messages"),!0).forEach(function(w){r(l,w)||l.push(w)}),l}function r(n,l){return f.find(n,t.bind(null,l))!==void 0}function t(n,l){return n.type===l.type&&n.message===l.message}return Re}var Oe={},dr;function Yr(){if(dr)return Oe;dr=1;var f=ct(),e=ft();Oe.openArrayBuffer=a,Oe.splitPath=o,Oe.joinPath=c;function a(s){return e.loadAsync(s).then(function(r){function t(p){return r.file(p)!==null}function n(p,u){return r.file(p).async("uint8array").then(function(m){if(u==="base64")return f.fromByteArray(m);if(u){var k=new TextDecoder(u);return k.decode(m)}else return m})}function l(p,u){r.file(p,u)}function w(){return r.generateAsync({type:"arraybuffer"})}return{exists:t,read:n,write:l,toArrayBuffer:w}})}function o(s){var r=s.lastIndexOf("/");return r===-1?{dirname:"",basename:s}:{dirname:s.substring(0,r),basename:s.substring(r+1)}}function c(){var s=Array.prototype.filter.call(arguments,function(t){return t}),r=[];return s.forEach(function(t){/^\//.test(t)?r=[t]:r.push(t)}),r.join("/")}return Oe}var Fe={},oe={},Te={},pr;function Gr(){if(pr)return Te;pr=1;var f=Z;Te.Element=a,Te.element=function(s,r,t){return new a(s,r,t)},Te.text=function(s){return{type:"text",value:s}};var e=Te.emptyElement={first:function(){return null},firstOrEmpty:function(){return e},attributes:{},children:[]};function a(s,r,t){this.type="element",this.name=s,this.attributes=r||{},this.children=t||[]}a.prototype.first=function(s){return f.find(this.children,function(r){return r.name===s})},a.prototype.firstOrEmpty=function(s){return this.first(s)||e},a.prototype.getElementsByTagName=function(s){var r=f.filter(this.children,function(t){return t.name===s});return c(r)},a.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var o={getElementsByTagName:function(s){return c(f.flatten(this.map(function(r){return r.getElementsByTagName(s)},!0)))}};function c(s){return f.extend(s,o)}return Te}var Ve={},He={},hr;function pt(){if(hr)return He;hr=1;var f=ut(),e=st();function a(o){var c=null,s=new f.DOMParser({errorHandler:function(t,n){c={level:t,message:n}}}),r=s.parseFromString(o);if(c===null)return r;throw new Error(c.level+": "+c.message)}return He.parseFromString=a,He.Node=e.Node,He}var vr;function ht(){if(vr)return Ve;vr=1;var f=fe(),e=Z,a=pt(),o=Gr(),c=o.Element;Ve.readString=r;var s=a.Node;function r(t,n){n=n||{};try{var l=a.parseFromString(t,"text/xml")}catch(m){return f.reject(m)}if(l.documentElement.tagName==="parsererror")return f.resolve(new Error(l.documentElement.textContent));function w(m){switch(m.nodeType){case s.ELEMENT_NODE:return p(m);case s.TEXT_NODE:return o.text(m.nodeValue)}}function p(m){var k=u(m),y=[];e.forEach(m.childNodes,function(T){var P=w(T);P&&y.push(P)});var h={};return e.forEach(m.attributes,function(T){h[u(T)]=T.value}),new c(k,h,y)}function u(m){if(m.namespaceURI){var k=n[m.namespaceURI],y;return k?y=k+":":y="{"+m.namespaceURI+"}",y+m.localName}else return m.localName}return f.resolve(w(l.documentElement))}return Ve}var Ze={},yr;function vt(){if(yr)return Ze;yr=1;var f=Z,e=mt();Ze.writeString=a;function a(c,s){var r=f.invert(s),t={element:l,text:o};function n(u,m){return t[m.type](u,m)}function l(u,m){var k=u.element(w(m.name),m.attributes);m.children.forEach(function(y){n(k,y)})}function w(u){var m=/^\{(.*)\}(.*)$/.exec(u);if(m){var k=r[m[1]];return k+(k===""?"":":")+m[2]}else return u}function p(u){var m=e.create(w(u.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return f.forEach(s,function(k,y){var h="xmlns"+(y===""?"":":"+y);m.attribute(h,k)}),u.children.forEach(function(k){n(m,k)}),m.end()}return p(c)}function o(c,s){c.text(s.value)}return Ze}var gr;function ir(){if(gr)return oe;gr=1;var f=Gr();return oe.Element=f.Element,oe.element=f.element,oe.emptyElement=f.emptyElement,oe.text=f.text,oe.readString=ht().readString,oe.writeString=vt().writeString,oe}var wr;function yt(){if(wr)return Fe;wr=1;var f=Z,e=fe(),a=ir();Fe.read=c,Fe.readXmlFromZipFile=s;var o={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function c(n){return a.readString(n,o).then(function(l){return t(l)[0]})}function s(n,l){return n.exists(l)?n.read(l,"utf-8").then(r).then(c):e.resolve(null)}function r(n){return n.replace(/^\uFEFF/g,"")}function t(n){return n.type==="element"?n.name==="mc:AlternateContent"?n.firstOrEmpty("mc:Fallback").children:(n.children=f.flatten(n.children.map(t,!0)),[n]):[n]}return Fe}var De={},Ae={},br;function gt(){if(br)return Ae;br=1,Ae.uriToZipEntryName=f,Ae.replaceFragment=e;function f(a,o){return o.charAt(0)==="/"?o.substr(1):a+"/"+o}function e(a,o){var c=a.indexOf("#");return c!==-1&&(a=a.substring(0,c)),a+"#"+o}return Ae}var Rr;function wt(){if(Rr)return De;Rr=1,De.createBodyReader=t,De._readNumberingProperties=l;var f=dt(),e=Z,a=ye(),o=se().Result,c=se().warning,s=ir(),r=gt();function t(I){return{readXmlElement:function(E){return new n(I).readXmlElement(E)},readXmlElements:function(E){return new n(I).readXmlElements(E)}}}function n(I){var E=[],v=[],R=[],S=I.relationships,x=I.contentTypes,O=I.docxFile,C=I.files,X=I.numbering,H=I.styles;function L(i){var g=i.map(V);return T(g)}function V(i){if(i.type==="element"){var g=N[i.name];if(g)return g(i);if(!Object.prototype.hasOwnProperty.call(p,i.name)){var q=c("An unrecognised element was ignored: "+i.name);return u([q])}}return m()}function G(i){return le(i).map(function(g){return{type:"paragraphProperties",styleId:g.styleId,styleName:g.name,alignment:i.firstOrEmpty("w:jc").attributes["w:val"],numbering:l(g.styleId,i.firstOrEmpty("w:numPr"),X),indent:Q(i.firstOrEmpty("w:ind"))}})}function Q(i){return{start:i.attributes["w:start"]||i.attributes["w:left"],end:i.attributes["w:end"]||i.attributes["w:right"],firstLine:i.attributes["w:firstLine"],hanging:i.attributes["w:hanging"]}}function K(i){return ke(i).map(function(g){var q=i.firstOrEmpty("w:sz").attributes["w:val"],_=/^[0-9]+$/.test(q)?parseInt(q,10)/2:null;return{type:"runProperties",styleId:g.styleId,styleName:g.name,verticalAlignment:i.firstOrEmpty("w:vertAlign").attributes["w:val"],font:i.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:_,isBold:z(i.first("w:b")),isUnderline:ae(i.first("w:u")),isItalic:z(i.first("w:i")),isStrikethrough:z(i.first("w:strike")),isAllCaps:z(i.first("w:caps")),isSmallCaps:z(i.first("w:smallCaps")),highlight:de(i.firstOrEmpty("w:highlight").attributes["w:val"])}})}function ae(i){if(i){var g=i.attributes["w:val"];return g!==void 0&&g!=="false"&&g!=="0"&&g!=="none"}else return!1}function z(i){if(i){var g=i.attributes["w:val"];return g!=="false"&&g!=="0"}else return!1}function me(i){return i!=="false"&&i!=="0"}function de(i){return!i||i==="none"?null:i}function le(i){return pe(i,"w:pStyle","Paragraph",H.findParagraphStyleById)}function ke(i){return pe(i,"w:rStyle","Run",H.findCharacterStyleById)}function xe(i){return pe(i,"w:tblStyle","Table",H.findTableStyleById)}function pe(i,g,q,_){var W=[],j=i.first(g),Y=null,be=null;if(j&&(Y=j.attributes["w:val"],Y)){var or=_(Y);or?be=or.name:W.push(it(q,Y))}return y({styleId:Y,name:be},W)}function Se(i){var g=i.attributes["w:fldCharType"];if(g==="begin")E.push({type:"begin",fldChar:i}),v=[];else if(g==="end"){var q=E.pop();if(q.type==="begin"&&(q=ge(q)),q.type==="checkbox")return k(a.checkbox({checked:q.checked}))}else if(g==="separate"){var _=E.pop(),W=ge(_);E.push(W)}return m()}function Ie(){var i=e.last(E.filter(function(g){return g.type==="hyperlink"}));return i?i.options:null}function ge(i){return U(v.join(""),i.type==="begin"?i.fldChar:s.emptyElement)}function U(i,g){var q=/\s*HYPERLINK "(.*)"/.exec(i);if(q)return{type:"hyperlink",options:{href:q[1]}};var _=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(i);if(_)return{type:"hyperlink",options:{anchor:_[1]}};var W=/\s*FORMCHECKBOX\s*/.exec(i);if(W){var j=g.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),Y=j.first("w:checked"),be=Y==null?z(j.first("w:default")):z(Y);return{type:"checkbox",checked:be}}return{type:"unknown"}}function te(i){return v.push(i.text()),m()}function qe(i){var g=i.attributes["w:font"],q=i.attributes["w:char"],_=f.hex(g,q);return _==null&&/^F0..$/.test(q)&&(_=f.hex(g,q.substring(2))),_==null?u([c("A w:sym element with an unsupported character was ignored: char "+q+" in font "+g)]):k(new a.Text(_.string))}function we(i){return function(g){var q=g.attributes["w:id"];return k(new a.NoteReference({noteType:i,noteId:q}))}}function d(i){return k(a.commentReference({commentId:i.attributes["w:id"]}))}function b(i){return L(i.children)}var N={"w:p":function(i){var g=i.firstOrEmpty("w:pPr"),q=!!g.firstOrEmpty("w:rPr").first("w:del");if(q)return i.children.forEach(function(W){R.push(W)}),m();var _=i.children;return R.length>0&&(_=R.concat(_),R=[]),h.map(G(g),L(_),function(W,j){return new a.Paragraph(j,W)}).insertExtra()},"w:r":function(i){return h.map(K(i.firstOrEmpty("w:rPr")),L(i.children),function(g,q){var _=Ie();return _!==null&&(q=[new a.Hyperlink(q,_)]),new a.Run(q,g)})},"w:fldChar":Se,"w:instrText":te,"w:t":function(i){return k(new a.Text(i.text()))},"w:tab":function(i){return k(new a.Tab)},"w:noBreakHyphen":function(){return k(new a.Text("‑"))},"w:softHyphen":function(i){return k(new a.Text("­"))},"w:sym":qe,"w:hyperlink":function(i){var g=i.attributes["r:id"],q=i.attributes["w:anchor"];return L(i.children).map(function(_){function W(Y){var be=i.attributes["w:tgtFrame"]||null;return new a.Hyperlink(_,e.extend({targetFrame:be},Y))}if(g){var j=S.findTargetByRelationshipId(g);return q&&(j=r.replaceFragment(j,q)),W({href:j})}else return q?W({anchor:q}):_})},"w:tbl":M,"w:tr":A,"w:tc":J,"w:footnoteReference":we("footnote"),"w:endnoteReference":we("endnote"),"w:commentReference":d,"w:br":function(i){var g=i.attributes["w:type"];return g==null||g==="textWrapping"?k(a.lineBreak):g==="page"?k(a.pageBreak):g==="column"?k(a.columnBreak):u([c("Unsupported break type: "+g)])},"w:bookmarkStart":function(i){var g=i.attributes["w:name"];return g==="_GoBack"?m():k(new a.BookmarkStart({name:g}))},"mc:AlternateContent":function(i){return b(i.firstOrEmpty("mc:Fallback"))},"w:sdt":function(i){var g=i.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(g){var q=g.first("wordml:checked"),_=!!q&&me(q.attributes["wordml:val"]);return k(a.checkbox({checked:_}))}else return L(i.firstOrEmpty("w:sdtContent").children)},"w:ins":b,"w:object":b,"w:smartTag":b,"w:drawing":b,"w:pict":function(i){return b(i).toExtra()},"v:roundrect":b,"v:shape":b,"v:textbox":b,"w:txbxContent":b,"wp:inline":ur,"wp:anchor":ur,"v:imagedata":at,"v:group":b,"v:rect":b};return{readXmlElement:V,readXmlElements:L};function M(i){var g=F(i.firstOrEmpty("w:tblPr"));return L(i.children).flatMap(ne).flatMap(function(q){return g.map(function(_){return a.Table(q,_)})})}function F(i){return xe(i).map(function(g){return{styleId:g.styleId,styleName:g.name}})}function A(i){var g=i.firstOrEmpty("w:trPr"),q=!!g.first("w:tblHeader");return L(i.children).map(function(_){return a.TableRow(_,{isHeader:q})})}function J(i){return L(i.children).map(function(g){var q=i.firstOrEmpty("w:tcPr"),_=q.firstOrEmpty("w:gridSpan").attributes["w:val"],W=_?parseInt(_,10):1,j=a.TableCell(g,{colSpan:W});return j._vMerge=ie(q),j})}function ie(i){var g=i.first("w:vMerge");if(g){var q=g.attributes["w:val"];return q==="continue"||!q}else return null}function ne(i){var g=e.any(i,function(W){return W.type!==a.types.tableRow});if(g)return y(i,[c("unexpected non-row element in table, cell merging may be incorrect")]);var q=e.any(i,function(W){return e.any(W.children,function(j){return j.type!==a.types.tableCell})});if(q)return y(i,[c("unexpected non-cell element in table row, cell merging may be incorrect")]);var _={};return i.forEach(function(W){var j=0;W.children.forEach(function(Y){Y._vMerge&&_[j]?_[j].rowSpan++:(_[j]=Y,Y._vMerge=!1),j+=Y.colSpan})}),i.forEach(function(W){W.children=W.children.filter(function(j){return!j._vMerge}),W.children.forEach(function(j){delete j._vMerge})}),k(i)}function ur(i){var g=i.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return T(g.map(rt.bind(null,i)))}function rt(i,g){var q=i.first("wp:docPr").attributes,_=tt(q.descr)?q.title:q.descr,W=nt(g);return W===null?u([c("Could not find image file for a:blip element")]):lr(W,_)}function tt(i){return i==null||/^\s*$/.test(i)}function nt(i){var g=i.attributes["r:embed"],q=i.attributes["r:link"];if(g)return sr(g);if(q){var _=S.findTargetByRelationshipId(q);return{path:_,read:C.read.bind(C,_)}}else return null}function at(i){var g=i.attributes["r:id"];return g?lr(sr(g),i.attributes["o:title"]):u([c("A v:imagedata element without a relationship ID was ignored")])}function sr(i){var g=r.uriToZipEntryName("word",S.findTargetByRelationshipId(i));return{path:g,read:O.read.bind(O,g)}}function lr(i,g){var q=x.findContentType(i.path),_=a.Image({readImage:i.read,altText:g,contentType:q}),W=w[q]?[]:c("Image of type "+q+" is unlikely to display in web browsers");return y(_,W)}function it(i,g){return c(i+" style with ID "+g+" was referenced but not defined in the document")}}function l(I,E,v){var R=E.firstOrEmpty("w:ilvl").attributes["w:val"],S=E.firstOrEmpty("w:numId").attributes["w:val"];if(R!==void 0&&S!==void 0)return v.findLevel(S,R);if(I!=null){var x=v.findLevelByParagraphStyleId(I);if(x!=null)return x}return null}var w={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},p={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function u(I){return new h(null,null,I)}function m(){return new h(null)}function k(I){return new h(I)}function y(I,E){return new h(I,null,E)}function h(I,E,v){this.value=I||[],this.extra=E||[],this._result=new o({element:this.value,extra:E},v),this.messages=this._result.messages}h.prototype.toExtra=function(){return new h(null,P(this.extra,this.value),this.messages)},h.prototype.insertExtra=function(){var I=this.extra;return I&&I.length?new h(P(this.value,I),null,this.messages):this},h.prototype.map=function(I){var E=this._result.map(function(v){return I(v.element)});return new h(E.value,this.extra,E.messages)},h.prototype.flatMap=function(I){var E=this._result.flatMap(function(v){return I(v.element)._result});return new h(E.value.element,P(this.extra,E.value.extra),E.messages)},h.map=function(I,E,v){return new h(v(I.value,E.value),P(I.extra,E.extra),I.messages.concat(E.messages))};function T(I){var E=o.combine(e.pluck(I,"_result"));return new h(e.flatten(e.pluck(E.value,"element")),e.filter(e.flatten(e.pluck(E.value,"extra")),B),E.messages)}function P(I,E){return e.flatten([I,E])}function B(I){return I}return De}var ze={},Tr;function bt(){if(Tr)return ze;Tr=1,ze.DocumentXmlReader=a;var f=ye(),e=se().Result;function a(o){var c=o.bodyReader;function s(r){var t=r.first("w:body");if(t==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var n=c.readXmlElements(t.children).map(function(l){return new f.Document(l,{notes:o.notes,comments:o.comments})});return new e(n.value,n.messages)}return{convertXmlToDocument:s}}return ze}var Pe={},Er;function Rt(){if(Er)return Pe;Er=1,Pe.readRelationships=f,Pe.defaultValue=new e([]),Pe.Relationships=e;function f(a){var o=[];return a.children.forEach(function(c){if(c.name==="relationships:Relationship"){var s={relationshipId:c.attributes.Id,target:c.attributes.Target,type:c.attributes.Type};o.push(s)}}),new e(o)}function e(a){var o={};a.forEach(function(s){o[s.relationshipId]=s.target});var c={};return a.forEach(function(s){c[s.type]||(c[s.type]=[]),c[s.type].push(s.target)}),{findTargetByRelationshipId:function(s){return o[s]},findTargetsByType:function(s){return c[s]||[]}}}return Pe}var We={},kr;function Tt(){if(kr)return We;kr=1,We.readContentTypesFromXml=e;var f={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};We.defaultContentTypes=a({},{});function e(o){var c={},s={};return o.children.forEach(function(r){if(r.name==="content-types:Default"&&(c[r.attributes.Extension]=r.attributes.ContentType),r.name==="content-types:Override"){var t=r.attributes.PartName;t.charAt(0)==="/"&&(t=t.substring(1)),s[t]=r.attributes.ContentType}}),a(s,c)}function a(o,c){return{findContentType:function(s){var r=o[s];if(r)return r;var t=s.split("."),n=t[t.length-1];if(c.hasOwnProperty(n))return c[n];var l=f[n.toLowerCase()];return l?"image/"+l:null}}}return We}var Ne={},xr;function Et(){if(xr)return Ne;xr=1;var f=Z;Ne.readNumberingXml=a,Ne.Numbering=e,Ne.defaultNumbering=new e({},{});function e(r,t,n){var l=f.flatten(f.values(t).map(function(m){return f.values(m.levels)})),w=f.indexBy(l.filter(function(m){return m.paragraphStyleId!=null}),"paragraphStyleId");function p(m,k){var y=r[m];if(y){var h=t[y.abstractNumId];if(h){if(h.numStyleLink==null)return t[y.abstractNumId].levels[k];var T=n.findNumberingStyleById(h.numStyleLink);return p(T.numId,k)}else return null}else return null}function u(m){return w[m]||null}return{findLevel:p,findLevelByParagraphStyleId:u}}function a(r,t){if(!t||!t.styles)throw new Error("styles is missing");var n=o(r),l=s(r);return new e(l,n,t.styles)}function o(r){var t={};return r.getElementsByTagName("w:abstractNum").forEach(function(n){var l=n.attributes["w:abstractNumId"];t[l]=c(n)}),t}function c(r){var t={};r.getElementsByTagName("w:lvl").forEach(function(l){var w=l.attributes["w:ilvl"],p=l.firstOrEmpty("w:numFmt").attributes["w:val"],u=l.firstOrEmpty("w:pStyle").attributes["w:val"];t[w]={isOrdered:p!=="bullet",level:w,paragraphStyleId:u}});var n=r.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:n}}function s(r){var t={};return r.getElementsByTagName("w:num").forEach(function(n){var l=n.attributes["w:numId"],w=n.first("w:abstractNumId").attributes["w:val"];t[l]={abstractNumId:w}}),t}return Ne}var Ce={},Sr;function kt(){if(Sr)return Ce;Sr=1,Ce.readStylesXml=e,Ce.Styles=f,Ce.defaultStyles=new f({},{});function f(s,r,t,n){return{findParagraphStyleById:function(l){return s[l]},findCharacterStyleById:function(l){return r[l]},findTableStyleById:function(l){return t[l]},findNumberingStyleById:function(l){return n[l]}}}f.EMPTY=new f({},{},{},{});function e(s){var r={},t={},n={},l={},w={paragraph:r,character:t,table:n};return s.getElementsByTagName("w:style").forEach(function(p){var u=a(p);if(u.type==="numbering")l[u.styleId]=c(p);else{var m=w[u.type];m&&(m[u.styleId]=u)}}),new f(r,t,n,l)}function a(s){var r=s.attributes["w:type"],t=s.attributes["w:styleId"],n=o(s);return{type:r,styleId:t,name:n}}function o(s){var r=s.first("w:name");return r?r.attributes["w:val"]:null}function c(s){var r=s.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:r}}return Ce}var Ee={},Ir;function xt(){if(Ir)return Ee;Ir=1;var f=ye(),e=se().Result;Ee.createFootnotesReader=a.bind(Ee,"footnote"),Ee.createEndnotesReader=a.bind(Ee,"endnote");function a(o,c){function s(n){return e.combine(n.getElementsByTagName("w:"+o).filter(r).map(t))}function r(n){var l=n.attributes["w:type"];return l!=="continuationSeparator"&&l!=="separator"}function t(n){var l=n.attributes["w:id"];return c.readXmlElements(n.children).map(function(w){return f.Note({noteType:o,noteId:l,body:w})})}return s}return Ee}var $e={},qr;function St(){if(qr)return $e;qr=1;var f=ye(),e=se().Result;function a(o){function c(r){return e.combine(r.getElementsByTagName("w:comment").map(s))}function s(r){var t=r.attributes["w:id"];function n(l){return(r.attributes[l]||"").trim()||null}return o.readXmlElements(r.children).map(function(l){return f.comment({commentId:t,body:l,authorName:n("w:author"),authorInitials:n("w:initials")})})}return c}return $e.createCommentsReader=a,$e}var Ke={},Or;function It(){if(Or)return Ke;Or=1;var f=fe();Ke.Files=e;function e(){function a(o){return f.reject(new Error("could not open external image: '"+o+`'
cannot open linked files from a web browser`))}return{read:a}}return Ke}var Pr;function qt(){if(Pr)return _e;Pr=1,_e.read=k,_e._findPartPaths=y;var f=fe(),e=ye(),a=se().Result,o=Yr(),c=yt().readXmlFromZipFile,s=wt().createBodyReader,r=bt().DocumentXmlReader,t=Rt(),n=Tt(),l=Et(),w=kt(),p=xt(),u=St(),m=It().Files;function k(x,O){return O=O||{},f.props({contentTypes:E(x),partPaths:y(x),docxFile:x,files:O.path?m.relativeToFile(O.path):new m(null)}).also(function(C){return{styles:R(x,C.partPaths.styles)}}).also(function(C){return{numbering:v(x,C.partPaths.numbering,C.styles)}}).also(function(C){return{footnotes:B(C.partPaths.footnotes,C,function(X,H){return H?p.createFootnotesReader(X)(H):new a([])}),endnotes:B(C.partPaths.endnotes,C,function(X,H){return H?p.createEndnotesReader(X)(H):new a([])}),comments:B(C.partPaths.comments,C,function(X,H){return H?u.createCommentsReader(X)(H):new a([])})}}).also(function(C){return{notes:C.footnotes.flatMap(function(X){return C.endnotes.map(function(H){return new e.Notes(X.concat(H))})})}}).then(function(C){return B(C.partPaths.mainDocument,C,function(X,H){return C.notes.flatMap(function(L){return C.comments.flatMap(function(V){var G=new r({bodyReader:X,notes:L,comments:V});return G.convertXmlToDocument(H)})})})})}function y(x){return S(x).then(function(O){var C=h({docxFile:x,relationships:O,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!x.exists(C))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return P({filename:I(C),readElement:t.readRelationships,defaultValue:t.defaultValue})(x).then(function(X){function H(L){return h({docxFile:x,relationships:X,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+L,basePath:o.splitPath(C).dirname,fallbackPath:"word/"+L+".xml"})}return{mainDocument:C,comments:H("comments"),endnotes:H("endnotes"),footnotes:H("footnotes"),numbering:H("numbering"),styles:H("styles")}})})}function h(x){var O=x.docxFile,C=x.relationships,X=x.relationshipType,H=x.basePath,L=x.fallbackPath,V=C.findTargetsByType(X),G=V.map(function(K){return T(o.joinPath(H,K),"/")}),Q=G.filter(function(K){return O.exists(K)});return Q.length===0?L:Q[0]}function T(x,O){return x.substring(0,O.length)===O?x.substring(O.length):x}function P(x){return function(O){return c(O,x.filename).then(function(C){return C?x.readElement(C):x.defaultValue})}}function B(x,O,C){var X=P({filename:I(x),readElement:t.readRelationships,defaultValue:t.defaultValue});return X(O.docxFile).then(function(H){var L=new s({relationships:H,contentTypes:O.contentTypes,docxFile:O.docxFile,numbering:O.numbering,styles:O.styles,files:O.files});return c(O.docxFile,x).then(function(V){return C(L,V)})})}function I(x){var O=o.splitPath(x);return o.joinPath(O.dirname,"_rels",O.basename+".rels")}var E=P({filename:"[Content_Types].xml",readElement:n.readContentTypesFromXml,defaultValue:n.defaultContentTypes});function v(x,O,C){return P({filename:O,readElement:function(X){return l.readNumberingXml(X,{styles:C})},defaultValue:l.defaultNumbering})(x)}function R(x,O){return P({filename:O,readElement:w.readStylesXml,defaultValue:w.defaultStyles})(x)}var S=P({filename:"_rels/.rels",readElement:t.readRelationships,defaultValue:t.defaultValue});return _e}var Xe={},Nr;function Ot(){if(Nr)return Xe;Nr=1;var f=Z,e=fe(),a=ir();Xe.writeStyleMap=r,Xe.readStyleMap=w;var o="http://schemas.zwobble.org/mammoth/style-map",c="mammoth/style-map",s="/"+c;function r(p,u){return p.write(c,u),t(p).then(function(){return n(p)})}function t(p){var u="word/_rels/document.xml.rels",m="http://schemas.openxmlformats.org/package/2006/relationships",k="{"+m+"}Relationship";return p.read(u,"utf8").then(a.readString).then(function(y){var h=y.children;l(h,k,"Id",{Id:"rMammothStyleMap",Type:o,Target:s});var T={"":m};return p.write(u,a.writeString(y,T))})}function n(p){var u="[Content_Types].xml",m="http://schemas.openxmlformats.org/package/2006/content-types",k="{"+m+"}Override";return p.read(u,"utf8").then(a.readString).then(function(y){var h=y.children;l(h,k,"PartName",{PartName:s,ContentType:"text/prs.mammoth.style-map"});var T={"":m};return p.write(u,a.writeString(y,T))})}function l(p,u,m,k){var y=f.find(p,function(h){return h.name===u&&h.attributes[m]===k[m]});y?y.attributes=k:p.push(a.element(u,k))}function w(p){return p.exists(c)?p.read(c,"utf8"):e.resolve(null)}return Xe}var Le={},he={},ue={},ce={},Cr;function Qr(){if(Cr)return ce;Cr=1;var f=Ue();function e(n,l,w){return o(f.element(n,l,{fresh:!1}),w)}function a(n,l,w){var p=f.element(n,l,{fresh:!0});return o(p,w)}function o(n,l){return{type:"element",tag:n,children:l||[]}}function c(n){return{type:"text",value:n}}var s={type:"forceWrite"};ce.freshElement=a,ce.nonFreshElement=e,ce.elementWithTag=o,ce.text=c,ce.forceWrite=s;var r={br:!0,hr:!0,img:!0,input:!0};function t(n){return n.children.length===0&&r[n.tag.tagName]}return ce.isVoidElement=t,ce}var Je,Br;function Pt(){if(Br)return Je;Br=1;var f=Z,e=Qr();function a(y){return o(l(y))}function o(y){var h=[];return y.map(c).forEach(function(T){n(h,T)}),h}function c(y){return s[y.type](y)}var s={element:r,text:t,forceWrite:t};function r(y){return e.elementWithTag(y.tag,o(y.children))}function t(y){return y}function n(y,h){var T=y[y.length-1];h.type==="element"&&!h.tag.fresh&&T&&T.type==="element"&&h.tag.matchesElement(T.tag)?(h.tag.separator&&n(T.children,e.text(h.tag.separator)),h.children.forEach(function(P){n(T.children,P)})):y.push(h)}function l(y){return w(y,function(h){return p[h.type](h)})}function w(y,h){return f.flatten(f.map(y,h),!0)}var p={element:m,text:k,forceWrite:u};function u(y){return[y]}function m(y){var h=l(y.children);return h.length===0&&!e.isVoidElement(y)?[]:[e.elementWithTag(y.tag,h)]}function k(y){return y.value.length===0?[]:[y]}return Je=a,Je}var Mr;function je(){if(Mr)return ue;Mr=1;var f=Qr();ue.freshElement=f.freshElement,ue.nonFreshElement=f.nonFreshElement,ue.elementWithTag=f.elementWithTag,ue.text=f.text,ue.forceWrite=f.forceWrite,ue.simplify=Pt();function e(r,t){t.forEach(function(n){a(r,n)})}function a(r,t){o[t.type](r,t)}var o={element:c,text:s,forceWrite:function(){}};function c(r,t){f.isVoidElement(t)?r.selfClosing(t.tag.tagName,t.tag.attributes):(r.open(t.tag.tagName,t.tag.attributes),e(r,t.children),r.close(t.tag.tagName))}function s(r,t){r.text(t.value)}return ue.write=e,ue}var _r;function Ue(){if(_r)return he;_r=1;var f=Z,e=je();he.topLevelElement=a,he.elements=o,he.element=s;function a(t,n){return o([s(t,n,{fresh:!0})])}function o(t){return new c(t.map(function(n){return f.isString(n)?s(n):n}))}function c(t){this._elements=t}c.prototype.wrap=function(n){for(var l=n(),w=this._elements.length-1;w>=0;w--)l=this._elements[w].wrapNodes(l);return l};function s(t,n,l){return l=l||{},new r(t,n,l)}function r(t,n,l){var w={};f.isArray(t)?(t.forEach(function(p){w[p]=!0}),t=t[0]):w[t]=!0,this.tagName=t,this.tagNames=w,this.attributes=n||{},this.fresh=l.fresh,this.separator=l.separator}return r.prototype.matchesElement=function(t){return this.tagNames[t.tagName]&&f.isEqual(this.attributes||{},t.attributes||{})},r.prototype.wrap=function(n){return this.wrapNodes(n())},r.prototype.wrapNodes=function(n){return[e.elementWithTag(this,n)]},he.empty=o([]),he.ignore={wrap:function(){return[]}},he}var Ye={},Fr;function et(){return Fr||(Fr=1,function(f){var e=Z,a=fe(),o=je();f.imgElement=c;function c(s){return function(r,t){return a.when(s(r)).then(function(n){var l={};return r.altText&&(l.alt=r.altText),e.extend(l,n),[o.freshElement("img",l)]})}}f.inline=f.imgElement,f.dataUri=c(function(s){return s.readAsBase64String().then(function(r){return{src:"data:"+s.contentType+";base64,"+r}})})}(Ye)),Ye}var Ge={},Qe={},Hr;function Nt(){if(Hr)return Qe;Hr=1;var f=Z;Qe.writer=e;function e(t){return t=t||{},t.prettyPrint?o():c()}var a={div:!0,p:!0,ul:!0,li:!0};function o(){var t=0,n="  ",l=[],w=!0,p=!1,u=c();function m(E,v){a[E]&&B(),l.push(E),u.open(E,v),a[E]&&t++,w=!1}function k(E){a[E]&&(t--,B()),l.pop(),u.close(E)}function y(E){P();var v=I()?E:E.replace(`
`,`
`+n);u.text(v)}function h(E,v){B(),u.selfClosing(E,v)}function T(){return l.length===0||a[l[l.length-1]]}function P(){p||(B(),p=!0)}function B(){if(p=!1,!w&&T()&&!I()){u._append(`
`);for(var E=0;E<t;E++)u._append(n)}}function I(){return f.some(l,function(E){return E==="pre"})}return{asString:u.asString,open:m,close:k,text:y,selfClosing:h}}function c(){var t=[];function n(y,h){var T=p(h);t.push("<"+y+T+">")}function l(y){t.push("</"+y+">")}function w(y,h){var T=p(h);t.push("<"+y+T+" />")}function p(y){return f.map(y,function(h,T){return" "+T+'="'+r(h)+'"'}).join("")}function u(y){t.push(s(y))}function m(y){t.push(y)}function k(){return t.join("")}return{asString:k,open:n,close:l,text:u,selfClosing:w,_append:m}}function s(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function r(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return Qe}var er={},Dr;function Ct(){if(Dr)return er;Dr=1;var f=Z;function e(p){return a(p,p)}function a(p,u){return function(){return{start:p,end:u}}}function o(p){var u=p.href||"";return u?{start:"[",end:"]("+u+")",anchorPosition:"before"}:{}}function c(p){var u=p.src||"",m=p.alt||"";return u||m?{start:"!["+m+"]("+u+")"}:{}}function s(p){return function(u,m){return{start:m?`
`:"",end:m?"":`
`,list:{isOrdered:p.isOrdered,indent:m?m.indent+1:0,count:0}}}}function r(p,u,m){u=u||{indent:0,isOrdered:!1,count:0},u.count++,m.hasClosed=!1;var k=u.isOrdered?u.count+".":"-",y=n("	",u.indent)+k+" ";return{start:y,end:function(){if(!m.hasClosed)return m.hasClosed=!0,`
`}}}var t={p:a("",`

`),br:a("",`  
`),ul:s({isOrdered:!1}),ol:s({isOrdered:!0}),li:r,strong:e("__"),em:e("*"),a:o,img:c};(function(){for(var p=1;p<=6;p++)t["h"+p]=a(n("#",p)+" ",`

`)})();function n(p,u){return new Array(u+1).join(p)}function l(){var p=[],u=[],m=null,k={};function y(E,v){v=v||{};var R=t[E]||function(){return{}},S=R(v,m,k);u.push({end:S.end,list:m}),S.list&&(m=S.list);var x=S.anchorPosition==="before";x&&h(v),p.push(S.start||""),x||h(v)}function h(E){E.id&&p.push('<a id="'+E.id+'"></a>')}function T(E){var v=u.pop();m=v.list;var R=f.isFunction(v.end)?v.end():v.end;p.push(R||"")}function P(E,v){y(E,v),T()}function B(E){p.push(w(E))}function I(){return p.join("")}return{asString:I,open:y,close:T,text:B,selfClosing:P}}er.writer=l;function w(p){return p.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}return er}var Ar;function Bt(){if(Ar)return Ge;Ar=1;var f=Nt(),e=Ct();Ge.writer=a;function a(o){return o=o||{},o.outputFormat==="markdown"?e.writer():f.writer(o)}return Ge}var Wr;function Mt(){if(Wr)return Le;Wr=1;var f=Z,e=fe(),a=ye(),o=Ue(),c=se(),s=et(),r=je(),t=Bt();Le.DocumentConverter=n;function n(h){return{convertToHtml:function(T){var P=f.indexBy(T.type===a.types.document?T.comments:[],"commentId"),B=new l(h,P);return B.convertToHtml(T)}}}function l(h,T){var P=1,B=[],I=[];h=f.extend({ignoreEmptyParagraphs:!0},h);var E=h.idPrefix===void 0?"":h.idPrefix,v=h.ignoreEmptyParagraphs,R=o.topLevelElement("p"),S=h.styleMap||[];function x(d){var b=[],N=C(d,b,{}),M=[];k(N,function(A){A.type==="deferred"&&M.push(A)});var F={};return e.mapSeries(M,function(A){return A.value().then(function(J){F[A.id]=J})}).then(function(){function A(ie){return m(ie,function(ne){return ne.type==="deferred"?F[ne.id]:ne.children?[f.extend({},ne,{children:A(ne.children)})]:[ne]})}var J=t.writer({prettyPrint:h.prettyPrint,outputFormat:h.outputFormat});return r.write(J,r.simplify(A(N))),new c.Result(J.asString(),b)})}function O(d,b,N){return m(d,function(M){return C(M,b,N)})}function C(d,b,N){if(!N)throw new Error("options not set");var M=we[d.type];return M?M(d,b,N):[]}function X(d,b,N){return H(d,b).wrap(function(){var M=O(d.children,b,N);return v?M:[r.forceWrite].concat(M)})}function H(d,b){var N=Q(d);return N?N.to:(d.styleId&&b.push(u("paragraph",d)),R)}function L(d,b,N){var M=function(){return O(d.children,b,N)},F=[];if(d.highlight!==null){var A=G({type:"highlight",color:d.highlight});A&&F.push(A)}d.isSmallCaps&&F.push(V("smallCaps")),d.isAllCaps&&F.push(V("allCaps")),d.isStrikethrough&&F.push(V("strikethrough","s")),d.isUnderline&&F.push(V("underline")),d.verticalAlignment===a.verticalAlignment.subscript&&F.push(o.element("sub",{},{fresh:!1})),d.verticalAlignment===a.verticalAlignment.superscript&&F.push(o.element("sup",{},{fresh:!1})),d.isItalic&&F.push(V("italic","em")),d.isBold&&F.push(V("bold","strong"));var J=o.empty,ie=Q(d);return ie?J=ie.to:d.styleId&&b.push(u("run",d)),F.push(J),F.forEach(function(ne){M=ne.wrap.bind(ne,M)}),M()}function V(d,b){var N=G({type:d});return N||(b?o.element(b,{},{fresh:!1}):o.empty)}function G(d,b){var N=Q(d);return N?N.to:b}function Q(d){for(var b=0;b<S.length;b++)if(S[b].from.matches(d))return S[b]}function K(d){return function(b,N){return e.attempt(function(){return d(b,N)}).caught(function(M){return N.push(c.error(M)),[]})}}function ae(d){return me(d.noteType,d.noteId)}function z(d){return de(d.noteType,d.noteId)}function me(d,b){return le(d+"-"+b)}function de(d,b){return le(d+"-ref-"+b)}function le(d){return E+d}var ke=o.elements([o.element("table",{},{fresh:!0})]);function xe(d,b,N){return G(d,ke).wrap(function(){return pe(d,b,N)})}function pe(d,b,N){var M=f.findIndex(d.children,function(ie){return!ie.type===a.types.tableRow||!ie.isHeader});M===-1&&(M=d.children.length);var F;if(M===0)F=O(d.children,b,f.extend({},N,{isTableHeader:!1}));else{var A=O(d.children.slice(0,M),b,f.extend({},N,{isTableHeader:!0})),J=O(d.children.slice(M),b,f.extend({},N,{isTableHeader:!1}));F=[r.freshElement("thead",{},A),r.freshElement("tbody",{},J)]}return[r.forceWrite].concat(F)}function Se(d,b,N){var M=O(d.children,b,N);return[r.freshElement("tr",{},[r.forceWrite].concat(M))]}function Ie(d,b,N){var M=N.isTableHeader?"th":"td",F=O(d.children,b,N),A={};return d.colSpan!==1&&(A.colspan=d.colSpan.toString()),d.rowSpan!==1&&(A.rowspan=d.rowSpan.toString()),[r.freshElement(M,A,[r.forceWrite].concat(F))]}function ge(d,b,N){return G(d,o.ignore).wrap(function(){var M=T[d.commentId],F=I.length+1,A="["+y(M)+F+"]";return I.push({label:A,comment:M}),[r.freshElement("a",{href:"#"+me("comment",d.commentId),id:de("comment",d.commentId)},[r.text(A)])]})}function U(d,b,N){var M=d.label,F=d.comment,A=O(F.body,b,N).concat([r.nonFreshElement("p",{},[r.text(" "),r.freshElement("a",{href:"#"+de("comment",F.commentId)},[r.text("↑")])])]);return[r.freshElement("dt",{id:me("comment",F.commentId)},[r.text("Comment "+M)]),r.freshElement("dd",{},A)]}function te(d,b,N){return qe(d).wrap(function(){return[]})}function qe(d){var b=Q(d);return b?b.to:d.breakType==="line"?o.topLevelElement("br"):o.empty}var we={document:function(d,b,N){var M=O(d.children,b,N),F=B.map(function(J){return d.notes.resolve(J)}),A=O(F,b,N);return M.concat([r.freshElement("ol",{},A),r.freshElement("dl",{},m(I,function(J){return U(J,b,N)}))])},paragraph:X,run:L,text:function(d,b,N){return[r.text(d.value)]},tab:function(d,b,N){return[r.text("	")]},hyperlink:function(d,b,N){var M=d.anchor?"#"+le(d.anchor):d.href,F={href:M};d.targetFrame!=null&&(F.target=d.targetFrame);var A=O(d.children,b,N);return[r.nonFreshElement("a",F,A)]},checkbox:function(d){var b={type:"checkbox"};return d.checked&&(b.checked="checked"),[r.freshElement("input",b)]},bookmarkStart:function(d,b,N){var M=r.freshElement("a",{id:le(d.name)},[r.forceWrite]);return[M]},noteReference:function(d,b,N){B.push(d);var M=r.freshElement("a",{href:"#"+ae(d),id:z(d)},[r.text("["+P+++"]")]);return[r.freshElement("sup",{},[M])]},note:function(d,b,N){var M=O(d.body,b,N),F=r.elementWithTag(o.element("p",{},{fresh:!1}),[r.text(" "),r.freshElement("a",{href:"#"+z(d)},[r.text("↑")])]),A=M.concat([F]);return r.freshElement("li",{id:ae(d)},A)},commentReference:ge,comment:U,image:p(K(h.convertImage||s.dataUri)),table:xe,tableRow:Se,tableCell:Ie,break:te};return{convertToHtml:x}}var w=1;function p(h){return function(T,P,B){return[{type:"deferred",id:w++,value:function(){return h(T,P,B)}}]}}function u(h,T){return c.warning("Unrecognised "+h+" style: '"+T.styleName+"' (Style ID: "+T.styleId+")")}function m(h,T){return f.flatten(h.map(T),!0)}function k(h,T){h.forEach(function(P){T(P),P.children&&k(P.children,T)})}var y=Le.commentAuthorLabel=function(T){return T.authorInitials||""};return Le}var rr={},Xr;function _t(){if(Xr)return rr;Xr=1;var f=ye();function e(a){if(a.type==="text")return a.value;if(a.type===f.types.tab)return"	";var o=a.type==="paragraph"?`

`:"";return(a.children||[]).map(e).join("")+o}return rr.convertElementToRawText=e,rr}var Be={},$={},Lr;function Ft(){if(Lr)return $;Lr=1,$.paragraph=f,$.run=e,$.table=a,$.bold=new c("bold"),$.italic=new c("italic"),$.underline=new c("underline"),$.strikethrough=new c("strikethrough"),$.allCaps=new c("allCaps"),$.smallCaps=new c("smallCaps"),$.highlight=o,$.commentReference=new c("commentReference"),$.lineBreak=new r({breakType:"line"}),$.pageBreak=new r({breakType:"page"}),$.columnBreak=new r({breakType:"column"}),$.equalTo=n,$.startsWith=l;function f(u){return new c("paragraph",u)}function e(u){return new c("run",u)}function a(u){return new c("table",u)}function o(u){return new s(u)}function c(u,m){m=m||{},this._elementType=u,this._styleId=m.styleId,this._styleName=m.styleName,m.list&&(this._listIndex=m.list.levelIndex,this._listIsOrdered=m.list.isOrdered)}c.prototype.matches=function(u){return u.type===this._elementType&&(this._styleId===void 0||u.styleId===this._styleId)&&(this._styleName===void 0||u.styleName&&this._styleName.operator(this._styleName.operand,u.styleName))&&(this._listIndex===void 0||t(u,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===u.breakType)};function s(u){u=u||{},this._color=u.color}s.prototype.matches=function(u){return u.type==="highlight"&&(this._color===void 0||u.color===this._color)};function r(u){u=u||{},this._breakType=u.breakType}r.prototype.matches=function(u){return u.type==="break"&&(this._breakType===void 0||u.breakType===this._breakType)};function t(u,m,k){return u.numbering&&u.numbering.level==m&&u.numbering.isOrdered==k}function n(u){return{operator:w,operand:u}}function l(u){return{operator:p,operand:u}}function w(u,m){return u.toUpperCase()===m.toUpperCase()}function p(u,m){return m.toUpperCase().indexOf(u.toUpperCase())===0}return $}var tr={},jr;function Ht(){if(jr)return tr;jr=1;var f=Jr(),e=f.RegexTokeniser;tr.tokenise=o;var a="'((?:\\\\.|[^'])*)";function o(c){var s="(?:[a-zA-Z\\-_]|\\\\.)",r=new e([{name:"identifier",regex:new RegExp("("+s+"(?:"+s+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(a+"'")},{name:"unterminated-string",regex:new RegExp(a)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return r.tokenise(c)}return tr}var Ur;function Dt(){if(Ur)return Be;Ur=1;var f=Z,e=Jr(),a=Ft(),o=Ue(),c=Ht().tokenise,s=se();Be.readHtmlPath=w,Be.readDocumentMatcher=n,Be.readStyle=r;function r(S){return I(R,S)}function t(){return e.rules.sequence(e.rules.sequence.capture(l()),e.rules.tokenOfType("whitespace"),e.rules.tokenOfType("arrow"),e.rules.sequence.capture(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("whitespace"),e.rules.sequence.capture(p())).head())),e.rules.tokenOfType("end")).map(function(S,x){return{from:S,to:x.valueOrElse(o.empty)}})}function n(S){return I(l(),S)}function l(){var S=e.rules.sequence,x=function(U,te){return e.rules.then(e.rules.token("identifier",U),function(){return te})},O=x("p",a.paragraph),C=x("r",a.run),X=e.rules.firstOf("p or r or table",O,C),H=e.rules.sequence(e.rules.tokenOfType("dot"),e.rules.sequence.cut(),e.rules.sequence.capture(u)).map(function(U){return{styleId:U}}),L=e.rules.firstOf("style name matcher",e.rules.then(e.rules.sequence(e.rules.tokenOfType("equals"),e.rules.sequence.cut(),e.rules.sequence.capture(k)).head(),function(U){return{styleName:a.equalTo(U)}}),e.rules.then(e.rules.sequence(e.rules.tokenOfType("startsWith"),e.rules.sequence.cut(),e.rules.sequence.capture(k)).head(),function(U){return{styleName:a.startsWith(U)}})),V=e.rules.sequence(e.rules.tokenOfType("open-square-bracket"),e.rules.sequence.cut(),e.rules.token("identifier","style-name"),e.rules.sequence.capture(L),e.rules.tokenOfType("close-square-bracket")).head(),G=e.rules.firstOf("list type",x("ordered-list",{isOrdered:!0}),x("unordered-list",{isOrdered:!1})),Q=S(e.rules.tokenOfType("colon"),S.capture(G),S.cut(),e.rules.tokenOfType("open-paren"),S.capture(m),e.rules.tokenOfType("close-paren")).map(function(U,te){return{list:{isOrdered:U.isOrdered,levelIndex:te-1}}});function K(U){var te=e.rules.firstOf.apply(e.rules.firstOf,["matcher suffix"].concat(U)),qe=e.rules.zeroOrMore(te);return e.rules.then(qe,function(we){var d={};return we.forEach(function(b){f.extend(d,b)}),d})}var ae=S(S.capture(X),S.capture(K([H,V,Q]))).map(function(U,te){return U(te)}),z=S(e.rules.token("identifier","table"),S.capture(K([H,V]))).map(function(U){return a.table(U)}),me=x("b",a.bold),de=x("i",a.italic),le=x("u",a.underline),ke=x("strike",a.strikethrough),xe=x("all-caps",a.allCaps),pe=x("small-caps",a.smallCaps),Se=S(e.rules.token("identifier","highlight"),e.rules.sequence.capture(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("open-square-bracket"),e.rules.sequence.cut(),e.rules.token("identifier","color"),e.rules.tokenOfType("equals"),e.rules.sequence.capture(k),e.rules.tokenOfType("close-square-bracket")).head()))).map(function(U){return a.highlight({color:U.valueOrElse(void 0)})}),Ie=x("comment-reference",a.commentReference),ge=S(e.rules.token("identifier","br"),S.cut(),e.rules.tokenOfType("open-square-bracket"),e.rules.token("identifier","type"),e.rules.tokenOfType("equals"),S.capture(k),e.rules.tokenOfType("close-square-bracket")).map(function(U){switch(U){case"line":return a.lineBreak;case"page":return a.pageBreak;case"column":return a.columnBreak}});return e.rules.firstOf("element type",ae,z,me,de,le,ke,xe,pe,Se,Ie,ge)}function w(S){return I(p(),S)}function p(){var S=e.rules.sequence.capture,x=e.rules.tokenOfType("whitespace"),O=e.rules.then(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("colon"),e.rules.token("identifier","fresh"))),function(L){return L.map(function(){return!0}).valueOrElse(!1)}),C=e.rules.then(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("colon"),e.rules.token("identifier","separator"),e.rules.tokenOfType("open-paren"),S(k),e.rules.tokenOfType("close-paren")).head()),function(L){return L.valueOrElse("")}),X=e.rules.oneOrMoreWithSeparator(u,e.rules.tokenOfType("choice")),H=e.rules.sequence(S(X),S(e.rules.zeroOrMore(B)),S(O),S(C)).map(function(L,V,G,Q){var K={},ae={};return V.forEach(function(z){z.append&&K[z.name]?K[z.name]+=" "+z.value:K[z.name]=z.value}),G&&(ae.fresh=!0),Q&&(ae.separator=Q),o.element(L,K,ae)});return e.rules.firstOf("html path",e.rules.then(e.rules.tokenOfType("bang"),function(){return o.ignore}),e.rules.then(e.rules.zeroOrMoreWithSeparator(H,e.rules.sequence(x,e.rules.tokenOfType("gt"),x)),o.elements))}var u=e.rules.then(e.rules.tokenOfType("identifier"),h),m=e.rules.tokenOfType("integer"),k=e.rules.then(e.rules.tokenOfType("string"),h),y={n:`
`,r:"\r",t:"	"};function h(S){return S.replace(/\\(.)/g,function(x,O){return y[O]||O})}var T=e.rules.sequence(e.rules.tokenOfType("open-square-bracket"),e.rules.sequence.cut(),e.rules.sequence.capture(u),e.rules.tokenOfType("equals"),e.rules.sequence.capture(k),e.rules.tokenOfType("close-square-bracket")).map(function(S,x){return{name:S,value:x,append:!1}}),P=e.rules.sequence(e.rules.tokenOfType("dot"),e.rules.sequence.cut(),e.rules.sequence.capture(u)).map(function(S){return{name:"class",value:S,append:!0}}),B=e.rules.firstOf("attribute or class",T,P);function I(S,x){var O=c(x),C=e.Parser(),X=C.parseTokens(S,O);return X.isSuccess()?s.success(X.value()):new s.Result(null,[s.warning(E(x,X))])}function E(S,x){return"Did not understand this style mapping, so ignored it: "+S+`
`+x.errors().map(v).join(`
`)}function v(S){return"Error was at character number "+S.characterNumber()+": Expected "+S.expected+" but got "+S.actual}var R=t();return Be}var Me={},Vr;function At(){if(Vr)return Me;Vr=1,Me.readOptions=o;var f=Z,e=Me._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],a=Me._standardOptions={transformDocument:s,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function o(r){return r=r||{},f.extend({},a,r,{customStyleMap:c(r.styleMap),readStyleMap:function(){var t=this.customStyleMap;return this.includeEmbeddedStyleMap&&(t=t.concat(c(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(t=t.concat(e)),t}})}function c(r){return r?f.isString(r)?r.split(`
`).map(function(t){return t.trim()}).filter(function(t){return t!==""&&t.charAt(0)!=="#"}):r:[]}function s(r){return r}return Me}var nr={},Zr;function Wt(){if(Zr)return nr;Zr=1;var f=fe(),e=Yr();nr.openZip=a;function a(o){return o.arrayBuffer?f.resolve(e.openArrayBuffer(o.arrayBuffer)):f.reject(new Error("Could not find file in options"))}return nr}var ve={},zr;function Xt(){if(zr)return ve;zr=1;var f=Z;ve.paragraph=e,ve.run=a,ve._elements=c,ve.getDescendantsOfType=s,ve.getDescendants=r;function e(n){return o("paragraph",n)}function a(n){return o("run",n)}function o(n,l){return c(function(w){return w.type===n?l(w):w})}function c(n){return function l(w){if(w.children){var p=f.map(w.children,l);w=f.extend(w,{children:p})}return n(w)}}function s(n,l){return r(n).filter(function(w){return w.type===l})}function r(n){var l=[];return t(n,function(w){l.push(w)}),l}function t(n,l){n.children&&n.children.forEach(function(w){t(w,l),l(w)})}return ve}var ar={},$r;function Lt(){if($r)return ar;$r=1;var f=Ue(),e=je();ar.element=a;function a(o){return function(c){return e.elementWithTag(f.element(o),[c])}}return ar}var Kr;function jt(){if(Kr)return ee;Kr=1;var f=Z,e=qt(),a=Ot(),o=Mt().DocumentConverter,c=_t().convertElementToRawText,s=Dt().readStyle,r=At().readOptions,t=Wt(),n=se().Result;ee.convertToHtml=l,ee.convertToMarkdown=w,ee.convert=p,ee.extractRawText=y,ee.images=et(),ee.transforms=Xt(),ee.underline=Lt(),ee.embedStyleMap=h,ee.readEmbeddedStyleMap=u;function l(T,P){return p(T,P)}function w(T,P){var B=Object.create(P||{});return B.outputFormat="markdown",p(T,B)}function p(T,P){return P=r(P),t.openZip(T).tap(function(B){return a.readStyleMap(B).then(function(I){P.embeddedStyleMap=I})}).then(function(B){return e.read(B,T).then(function(I){return I.map(P.transformDocument)}).then(function(I){return m(I,P)})})}function u(T){return t.openZip(T).then(a.readStyleMap)}function m(T,P){var B=k(P.readStyleMap()),I=f.extend({},P,{styleMap:B.value}),E=new o(I);return T.flatMapThen(function(v){return B.flatMapThen(function(R){return E.convertToHtml(v)})})}function k(T){return n.combine((T||[]).map(s)).map(function(P){return P.filter(function(B){return!!B})})}function y(T){return t.openZip(T).then(e.read).then(function(P){return P.map(c)})}function h(T,P){return t.openZip(T).tap(function(B){return a.writeStyleMap(B,P)}).then(function(B){return B.toArrayBuffer()}).then(function(B){return{toArrayBuffer:function(){return B},toBuffer:function(){return Buffer.from(B)}}})}return ee.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)},ee}var Ut=jt();const Qt=lt(Ut);export{Qt as m};
